% \documentclass[a4paper, twoside, nobib, justified, nofonts]{tufte-book}
% \documentclass[a4paper, twoside, nobib    , justified]{tufte-book}
\documentclass[a4paper, twoside, nobib, justified]{tufte-book} % notoc, justified,marginals=raggedouter
% right ragged (aligned right)
% nofonts for using other fonts

% \usepackage{palatino}
% \usepackage{helvet}

\hypersetup{colorlinks}% uncomment this line if you prefer colored hyperlinks (e.g., for onscreen viewing)

%%
% Book metadata
\title[A Physicist's Approach To Machine Learning -- Understanding The Basic Bricks]{A Physicist's \newline \noindent 
       Approach to \newline \noindent 
       Machine Learning \newline \noindent
       --  \newline \noindent
       Understanding  \newline \noindent
       The Basic Bricks}
\author[Christian Michelsen]{\newline \noindent 
        Christian Michelsen \newline \noindent 
        Niels Bohr Institute \newline \noindent 
        University of Copenhagen \newline }
\publisher[]{Supervisor: \newline \noindent 
           Troels Petersen \newline \noindent
           Niels Bohr Institute \newline \noindent
           University of Copenhagen}

%%
% If they're installed, use Bergamo and Chantilly from www.fontsite.com.
% They're clones of Bembo and Gill Sans, respectively.
%\IfFileExists{bergamo.sty}{\usepackage[osf]{bergamo}}{}% Bembo
%\IfFileExists{chantill.sty}{\usepackage{chantill}}{}% Gill Sans

%\usepackage{microtype}

% when using custom bibliography
\usepackage[square, numbers, nonamebreak]{natbib}
\bibliographystyle{abbrvnat}


%%
% Just some sample text
\usepackage{lipsum}

% package for quotes
\usepackage{epigraph}
\setlength\epigraphwidth{.8\textwidth}
% \setlength\epigraphrule{0pt}

%%
% For nicely typeset tabular material
\usepackage{booktabs}

% maths packages
\usepackage{amsthm,amssymb,amsmath}
\usepackage[mathscr]{eucal}

%%
% For graphics / images
\usepackage{graphicx}
\setkeys{Gin}{width=\linewidth,totalheight=\textheight,keepaspectratio}
\graphicspath{{graphics/}{{figures/}}}

% allow for dots in filename
\usepackage{grffile}


\usepackage{tikz}
\usepackage[subpreambles=true]{standalone}

% subcaption does not work with Tufte
\usepackage[caption=false]{subfig}
% \usepackage[export]{adjustbox}


% The fancyvrb package lets us customize the formatting of verbatim
% environments.  We use a slightly smaller font.
\usepackage{fancyvrb}
\fvset{fontsize=\normalsize}

%%
% Prints argument within hanging parentheses (i.e., parentheses that take
% up no horizontal space).  Useful in tabular environments.
\newcommand{\hangp}[1]{\makebox[0pt][r]{(}#1\makebox[0pt][l]{)}}

%%
% Prints an asterisk that takes up no horizontal space.
% Useful in tabular environments.
\newcommand{\hangstar}{\makebox[0pt][l]{*}}

%%
% Prints a trailing space in a smart way.
\usepackage{xspace}


% % slashed symbols
% \usepackage{slashed}
\usepackage{centernot}

% ignore overfull up to 5pt
\hfuzz=20.002pt 

\newcommand{\Independent}{\mathrel{\perp\mspace{-10mu}\perp}}
\newcommand{\NotIndependent}{\centernot{\Independent}}


% add numbers to chapters, sections, subsections
\setcounter{secnumdepth}{2}
\setcounter{tocdepth}{2}

% Feynman diagrams
% \usepackage{tikz-feynman}
% \usepackage{feynman}

% lemmas and corollaries
% \newtheorem{theorem}{Theorem}[section]
% \newtheorem{corollary}{Corollary}[theorem]
% \newtheorem{lemma}[theorem]{Lemma}
\newtheorem{lemma}{Lemma}
\newtheorem{sublemma}{Lemma}[lemma]
\newtheorem{corollary}{Corollary}
\newtheorem{theorem}{Theorem}
\newtheorem{axiom}{Axiom}

% "Force" axioms to be on the same page if possible
% https://tex.stackexchange.com/questions/30120/avoid-page-break-in-theorem
\usepackage{etoolbox}% 
\usepackage{needspace}% http://ctan.org/pkg/needspace
\AtBeginEnvironment{axiom}{\Needspace{5\baselineskip}}% \break if fewer than 5\baselineskip is available on page
\AtBeginEnvironment{theorem}{\Needspace{5\baselineskip}}% \break if fewer than 5\baselineskip is available on page


% bold math
\usepackage{bm}

% more control over enumerate
\usepackage{enumitem}

% for vector norms and abs
\newcommand{\abs}[1]{\lvert#1\rvert}
\newcommand{\norm}[1]{\lVert#1\rVert}

% allow first, second and third, 1st 2nd 3rd
\usepackage[super]{nth}

% % for using Inkscape plots
\usepackage{import}
\usepackage{xifthen}
\usepackage{pdfpages}
\usepackage{transparent}
\newcommand{\incfig}[1]{%
    \def\svgwidth{\columnwidth}
    \import{./figures/}{#1.pdf_tex}
}



%  units
\usepackage[binary-units=true]{siunitx}
\sisetup{seperr}
\DeclareSIUnit{\kroner}{kr.}
\DeclareSIUnit{\kr}{kr.}
\DeclareSIUnit{\Mkr}{M.kr.}
\DeclareSIUnit{\year}{year}
\DeclareSIUnit{\years}{years}
\DeclareSIUnit{\yr}{yr}

%  alignment in matrix matrices
\usepackage{mathtools}

% % allows for writing indices in matrices (matrix) outside 
% \usepackage{kbordermatrix}

% \usepackage{etoolbox}
% \let\bbordermatrix\bordermatrix
% \patchcmd{\bbordermatrix}{8.75}{4.75}{}{}
% \patchcmd{\bbordermatrix}{\left(}{\left[}{}{}
% \patchcmd{\bbordermatrix}{\right)}{\right]}{}{}



% custom subsubsection:
\titleclass{\subsubsection}{straight}
\titleformat{\subsubsection}%
  [hang]% shape
  {\normalfont\itshape}% format applied to label+text
  {\thesubsubsection}% label
  {1em}% horizontal separation between label and title body
  {}% before the title body
  []% after the title body


% custom centering of figure 
\makeatletter
\newcommand*{\centerfloat}{%
  \parindent \z@
  \leftskip \z@ \@plus 1fil \@minus \textwidth
  \rightskip\leftskip
  \parfillskip \z@skip}
\makeatother

% roman numerals
\newcommand{\RNum}[1]{\uppercase\expandafter{\romannumeral #1\relax}}


%  maybe a smaller filesize
\pdfminorversion=5 
\pdfcompresslevel=9
\pdfobjcompresslevel=2



\usepackage[dvipsnames]{xcolor}
\definecolor{red} {RGB}{227, 26, 28}
\definecolor{blue}{RGB}{31, 120, 180}
\definecolor{green}{RGB}{51, 160, 44}
\definecolor{orange}{RGB}{255, 127, 0}
\definecolor{purple}{RGB}{106, 61, 154}

% \definecolor{light-blue}{RGB}{166, 206, 227}  
\definecolor{light-blue}{RGB}{133, 165, 182}
\definecolor{light-green}{RGB}{178, 223, 138}
\definecolor{light-purple}{RGB}{202, 178, 214}

\definecolor{viridis-light}{RGB}{252, 226, 63}
\definecolor{viridis-dark}{RGB}{59, 18, 72}





\definecolor{light-gray}{gray}{0.95}


% make a code environment
\newcommand{\code}[1]{\colorbox{light-gray}{\texttt{\detokenize{#1}}}}

% make quote signs
\newcommand{\q}[1]{``#1''}

% make Figure quote
\newcommand{\figref}[1]{Figure ~\ref{#1}}

% avoid problems with autocite not properly defined
\newcommand{\autocite}[1]{\citep{#1}}

% bold vector
\renewcommand{\vec}[1]{\mathbf{#1}}

\DeclareMathOperator*{\argmin}{arg\,min} % Jan Hlavacek


% correct spacing for \sim
% \newcommand{\unsim}{\mathord{\sim}}



% short dash
\mathchardef\dash="2D

% to have references in normal text and not sidenotes, see:
% https://tex.stackexchange.com/questions/247636/how-to-remove-sidenote-citations-in-tufte-latex


% chapter format
\titleformat{\chapter}%
  {\huge\rmfamily\itshape}% format applied to label+text
  {\itshape\Huge\thechapter\hspace{1pt}.\hspace{4pt}} % label
  {0pt}% horizontal separation between label and title body
  {}% before the title body
  []% after the title body



% Prints the month name (e.g., January) and the year (e.g., 2008)
\newcommand{\monthyear}{%
  \ifcase\month\or January\or February\or March\or April\or May\or June\or
  July\or August\or September\or October\or November\or
  December\fi\space\number\year
}

% =============================================
%Import symbols from font cmmi without importing the whole package
% =============================================
\DeclareFontFamily{U} {cmmi}{}

\DeclareFontShape{U}{cmmi}{m}{n}{
  <-6> cmmi5
  <6-7> cmmi6
  <7-8> cmmi7
  <8-9> cmmi8
  <9-10> cmmi9
  <10-12> cmmi10
  <12-> cmmi12}{}

\DeclareSymbolFont{Xcmmi} {U} {cmmi}{m}{n}

% http://www.ctex.org/documents/shredder/src/texbook.pdf
% \let\altxi\xi
% \DeclareMathSymbol{\xi}{\mathord}{Xcmmi}{24}
\let\altrho\rho
\DeclareMathSymbol{\rho}{\mathord}{Xcmmi}{26}
\let\alttau\tau
\DeclareMathSymbol{\tau}{\mathord}{Xcmmi}{28}
\let\altchi\chi
\DeclareMathSymbol{\chi}{\mathord}{Xcmmi}{31}
\let\altphi\phi
\DeclareMathSymbol{\phi}{\mathord}{Xcmmi}{30}
% \let\altPhi\Phi
% \DeclareMathSymbol{\Phi}{\mathord}{Xcmmi}{8}
% \let\altPsi\Psi
% \DeclareMathSymbol{\Psi}{\mathord}{Xcmmi}{9}
% \let\altalpha\alpha
% \DeclareMathSymbol{\alpha}{\mathord}{Xcmmi}{11}



% =============================================

\newcommand{\TODO}{\textcolor{red}{\bf TODO!}\xspace}


% Custom TOC
\titlecontents{part}%
  [0em] % distance from left margin
  {\vspace{0.8\baselineskip}\huge\rmfamily\itshape} % above (global formatting of entry)
  {\hspace*{0em}\contentslabel{2em}} % before w/label (label = ``2'')
  % {\hspace*{0em}\contentslabel[\huge\rmfamily\itshape Part \thecontentslabel]{2em}}
  {\hspace*{0em}\contentslabel{2em}} % before w/o label
  {\titlerule*[0.8em]{}\rmfamily\upshape\contentspage} % filler + page (leaders and page num)
  [\vspace{0.1\baselineskip}] % after

\titlecontents{chapter}%
  [0em] % distance from left margin
  {\vspace{0.8\baselineskip}\LARGE\rmfamily\itshape} % above (global formatting of entry)
  {\hspace*{0em}\contentslabel{2em}} % before w/label (label = ``2'')
  {\hspace*{0em}} % before w/o label
  {\titlerule*[0.8em]{}\rmfamily\upshape\contentspage} % filler + page (leaders and page num)
  [\vspace{0.1\baselineskip}] % after

\titlecontents{section}%
  [0em] % distance from left margin
  {\vspace{0.08\baselineskip}\Large\rmfamily\itshape} % above (global formatting of entry)
  {\hspace*{2em}\contentslabel{2.2em}} % before w/label (label = ``2'')
  {\hspace*{2em}} % before w/o label
  {\titlerule*[0.8em]{.}\large\rmfamily\upshape\contentspage} % filler + page (leaders and page num)
  [\vspace{0.01\baselineskip}] % after

\titlecontents{subsection}%
  [0em] % distance from left margin
  {\vspace{0.08\baselineskip}\normalsize\rmfamily\itshape} % above (global formatting of entry)
  {\hspace*{5em}\contentslabel{3em}} % before w/label (label = ``2'')
  {\hspace*{5em}} % before w/o label
  {\titlerule*[0.8em]{.}\normalsize\rmfamily\upshape\contentspage} % filler + page (leaders and page num)
  [\vspace{0.01\baselineskip}] % after


% % Fix spacing in list of figures and list of tables
\usepackage{tocbasic}
\DeclareTOCStyleEntry[dynnumwidth]{tocline}{figure}% for figure entries
\DeclareTOCStyleEntry[dynnumwidth]{tocline}{table}% for table entries

% % Custom Figure Titles
% \newcommand*{\figuretitle}[1]{%
%     {\centering%   <--------  will only affect the title because of the grouping (by the
%     \textbf{#1}%              braces before \centering and behind \medskip). If you remove
%     \par\medskip}%            these braces the whole body of a {figure} env will be centered.
% }


% This page is intentionally left blank
% https://tex.stackexchange.com/questions/1727/how-do-i-make-pages-which-were-intentionally-left-blank
\newcommand*{\blankpage}{%
\vspace*{\fill}
{\centering \textit{(This page is intentionally left blank).}\par}
\vspace{\fill}}
\makeatletter
\renewcommand*{\cleardoublepage}{\clearpage\if@twoside \ifodd\c@page\else
\blankpage
\thispagestyle{empty}
\newpage
\if@twocolumn\hbox{}\newpage\fi\fi\fi}
\makeatother



% \let\Oldpart\part
% \newcommand{\parttitle}{}
% \renewcommand{\part}[1]{\Oldpart{#1}\renewcommand{\parttitle}{#1}}



% Generates the index
\usepackage{makeidx}
\makeindex

% un-breakeable dashes. HAS TO BE LAST PACKAGE TO BE LOADED
\usepackage[shortcuts]{extdash}

% extdash breakable dashes
% Words hyphened with these dashes can also be broken at other positions than the dash

% \-/ hyphen
% \-- en-dash
% \--- em-dash
% extdash unbreakable dashes
% No line breaks possible at the hyphen

% \=/ hyphen
% \== en-dash
% \=== em-dash

\pagenumbering{roman}


% \includeonly{chapter_foreword,chapter_introduction,chapter_machine_learning_theory,chapter_housing_prices,chapter_particle_physics_theory,chapter_quark_gluon,chapter_appendix_housing,chapter_appendix_quarks_gluons}

% \includeonly{chapter_quark_gluon}
% \includeonly{chapter_quark_gluon,chapter_appendix_quarks_gluons}

% \includeonly{chapter_housing_prices}  
% \includeonly{chapter_housing_prices,chapter_appendix_housing}

% \includeonly{chapter_particle_physics_theory}

\includeonly{chapter_introduction}


\begin{document}

% r.3 full title page
% \maketitle
\begin{titlepage}
  \includepdf{./frontpage/frontpage}
\end{titlepage}

%  copyright page
\input{copyright.tex}

\chapter*{Abstract}
\addcontentsline{toc}{chapter}{Abstract}
Within the last decade, the rise of machine learning, deep learning and big data has been evident. The individual fields have seen enormous developments and their tools and methods have been applied to a plethora of use cases. Within the field of particle physics, some of these algorithms have already been in use for more than 25 years. Electron-positron collisions at LEP are an example of one of these disciplines. In the ALEPH detector, individual jets are classified according their $b$-tag prediction score. Using modern machine learning methods, the jet-based $b$-tagging model is improved compared to the neural network approach taken by ALEPH in the early 1990s. This model is extended with a permutation invariant, event-based $g$-tagging model which is trained on the individual $b$-tags in each event providing a $g$-tag score. This model identifies events with clear quark-gluon discrimination which allow individual gluons to be selected. Based on these, the gluon hadronization and splitting characteristics are measured in different regions of the phase space and compared between Monte Carlo and data. We show a good correspondence between the distributions measured in MC and data with fractional systematic uncertainties in the single digits. 

The methods used to optimize the $b$-tagging and $g$-tagging models are based on methods developed during the housing data project, a project with the aim of estimating Danish housing prices based on data from Boligsiden. Applying machine learning as a regression tool, we show that the hyperparameter optimized model is able to predict more than \SI{40}{\percent} of all apartment sales to be within $\pm\SI{5}{\percent}$ of the actual sold price and more than \SI{25}{\percent} of all house sales. Using the median absolute deviation around 0, $\mathrm{MAD}_0$, as the evaluation function, we find that we are able to get a $\mathrm{MAD}_0$ of \SI{8.5}{\percent} (\SI{14.9}{\percent}) compared to the realtors' \SI{4.9}{\percent} (\SI{7.6}{\percent}) for apartments (houses) for outlier corrected subset of the data. It was shown that further improvements in performance could be achieved by including text descriptions in addition to the numeric variables.

% Taken as a whole, these two projects help to explain the widespread use of machine learning in such different fields as particle physics and housing predictions simply due to its high performing models. A compromise between model performance and model interpretability is 


% Needed for proper numbering of TOC
\cleardoublepage
\phantomsection
\addcontentsline{toc}{chapter}{Table of Contents}

\tableofcontents


%%
%  # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # 

\include{chapter_foreword}

% Start the main matter (normal chapters)
\mainmatter
\pagenumbering{arabic}

\include{chapter_introduction}



% \part*{Part1}
% \label{part1}
\phantomsection
\chapter*{}
\addcontentsline{toc}{part}{Part I}
\label{part1}
{\Huge \rmfamily Part I}
% \addcontentsline{toc}{part}{Part I}
% \addcontentsline{toc}{part}{\nameref{part1}}

% Part \RNum{1} of this thesis covers the introductory theory of machine learning in \autoref{ch:ML_theory} along with some extra technical aspects of it. In \autoref{ch:housing_price_analysis} machine learning is applied to estimate Danish housing prices as precisely and accurately as possible.  

\include{chapter_machine_learning_theory}
\include{chapter_housing_prices}

%  # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # 

\phantomsection
\chapter*{}
\addcontentsline{toc}{part}{Part II}
\label{part2}
{\Huge \rmfamily Part II}
% \cleardoublepage

% \part{Part II}
% \part{Particle Physics and Quark Gluon Discrimination}
% \label{part2}

% \part*{Part2}
% \label{part2}
% \phantomsection
% \addcontentsline{toc}{part}{Part II}
% Part \RNum{2} of this thesis deals with particle physics and the discriminatory power of machine learning for quark-gluon identification and subsequent analysis. In \autoref{ch:hep:particle_physcis_LEP} the theory of the Standard Model is introduced together with a description of the ALEPH detector. Theory is applied in \autoref{ch:quark_gluon_analysis} where the types of jets and events in each collision is analysed using machine learning to improve the understanding of how gluon jets hadronizes and splits: simply said how they look and behave. 


\include{chapter_particle_physics_theory}
\include{chapter_quark_gluon}


%%
% The back matter contains appendices, bibliographies, indices, glossaries, etc.

\appendix

\include{chapter_appendix_housing}
\include{chapter_appendix_quarks_gluons}

\backmatter

\begin{fullwidth}
\listoffigures
\addcontentsline{toc}{chapter}{List of Figures}
\end{fullwidth}

\begin{fullwidth}
\listoftables
\addcontentsline{toc}{chapter}{List of Tables}
\end{fullwidth}


\cleardoublepage
\phantomsection
\addcontentsline{toc}{chapter}{Bibliography}
\bibliography{My_Library}

\printindex

\end{document}

